<!-- Dashboard Header -->
<div class="dashboard-header">
    <h1 class="dashboard-title">Dashboard</h1>
    <p class="dashboard-subtitle">
        Welcome back! Here's what's happening with your business today.
    </p>
</div>

<div class="stats-section">
    <h3 class="section-title">Current Total</h3>
    <div class="stat-card big-highlight">
        <div class="stat-icon primary">
            <i class="fas fa-balance-scale"></i>
        </div>
        <div class="stat-value">
            $<%= ((stats.invoiceStats?.totalPaid || 0) - (stats.expenseStats?.totalExpenses || 0)).toFixed(1) %>
        </div>
        <div class="stat-label">Total the business have</div>
    </div>
</div>


<!-- Financial Overview Section -->
<div class="stats-section">
    <h3 class="section-title">Financial Overview</h3>
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon success">
                <i class="fas fa-arrow-up"></i>
            </div>
            <div class="stat-value">$<%= ((stats.invoiceStats?.totalPaid || 0)).toFixed(1) %></div>
            <div class="stat-label">Total Revenue</div>
        </div>

        <div class="stat-card">
            <div class="stat-icon danger">
                <i class="fas fa-arrow-down"></i>
            </div>
            <div class="stat-value">
                $<%= ((stats.expenseStats?.totalExpenses || 0)).toFixed(1) %>
            </div>
            <div class="stat-label">Total Expenses</div>
        </div>

        <div class="stat-card">
            <div
                class="stat-icon <%= stats.expenseStats?.monthlyProfit >= 0 ? 'success' : 'danger' %>"
            >
                <i class="fas fa-chart-line"></i>
            </div>
            <div class="stat-value">
                $<%= ((stats.expenseStats?.monthlyProfit || 0)).toFixed(1) %>
            </div>
            <div class="stat-label">Monthly Profit</div>
        </div>

        <div class="stat-card">
            <div class="stat-icon warning">
                <i class="fas fa-receipt"></i>
            </div>
            <div class="stat-value"><%= stats.expenseStats?.monthlyCount || 0 %></div>
            <div class="stat-label">Expenses This Month</div>
        </div>
    </div>
</div>

<!-- Client Stats Section -->
<div class="stats-section">
    <h3 class="section-title">Clients</h3>
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon primary">
                <i class="fas fa-users"></i>
            </div>
            <div class="stat-value"><%= stats.clientStats?.active || 0 %></div>
            <div class="stat-label">Active</div>
        </div>

        <div class="stat-card">
            <div class="stat-icon info">
                <i class="fas fa-user-clock"></i>
            </div>
            <div class="stat-value"><%= stats.clientStats?.lead || 0 %></div>
            <div class="stat-label">Leads</div>
        </div>

        <div class="stat-card">
            <div class="stat-icon warning">
                <i class="fas fa-user-minus"></i>
            </div>
            <div class="stat-value"><%= stats.clientStats?.inactive || 0 %></div>
            <div class="stat-label">Inactive</div>
        </div>

        <div class="stat-card">
            <div class="stat-icon secondary">
                <i class="fas fa-user-check"></i>
            </div>
            <div class="stat-value"><%= stats.clientStats?.total || 0 %></div>
            <div class="stat-label">Total Clients</div>
        </div>
    </div>
</div>

<!-- Invoice Stats Section -->
<div class="stats-section">
    <h3 class="section-title">Invoices</h3>
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon success">
                <i class="fas fa-dollar-sign"></i>
            </div>
            <div class="stat-value">$<%= ((stats.invoiceStats?.totalPaid || 0)).toFixed(1) %></div>
            <div class="stat-label">Total Paid</div>
        </div>

        <div class="stat-card">
            <div class="stat-icon warning">
                <i class="fas fa-file-invoice-dollar"></i>
            </div>
            <div class="stat-value">
                $<%= ((stats.invoiceStats?.totalPending || 0)).toFixed(1) %>
            </div>
            <div class="stat-label">Pending</div>
        </div>

        <div class="stat-card">
            <div class="stat-icon info">
                <i class="fas fa-paper-plane"></i>
            </div>
            <div class="stat-value"><%= stats.invoiceStats?.sent || 0 %></div>
            <div class="stat-label">Sent</div>
        </div>

        <div class="stat-card">
            <div class="stat-icon danger">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <div class="stat-value"><%= stats.invoiceStats?.overdue || 0 %></div>
            <div class="stat-label">Overdue</div>
        </div>
    </div>
</div>

<!-- Proposal Stats Section -->
<div class="stats-section">
    <h3 class="section-title">Proposals</h3>
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon primary">
                <i class="fas fa-file-alt"></i>
            </div>
            <div class="stat-value"><%= stats.proposalStats?.sent || 0 %></div>
            <div class="stat-label">Sent</div>
        </div>

        <div class="stat-card">
            <div class="stat-icon info">
                <i class="fas fa-eye"></i>
            </div>
            <div class="stat-value"><%= stats.proposalStats?.viewed || 0 %></div>
            <div class="stat-label">Viewed</div>
        </div>

        <div class="stat-card">
            <div class="stat-icon success">
                <i class="fas fa-check-circle"></i>
            </div>
            <div class="stat-value"><%= stats.proposalStats?.accepted || 0 %></div>
            <div class="stat-label">Accepted</div>
        </div>

        <div class="stat-card">
            <div class="stat-icon secondary">
                <i class="fas fa-file-signature"></i>
            </div>
            <div class="stat-value">
                $<%= ((stats.proposalStats?.totalValue || 0)).toFixed(1) %>
            </div>
            <div class="stat-label">Total Value</div>
        </div>
    </div>
</div>

<!-- Charts Row -->
<div class="charts-row">
    <!-- Revenue Chart -->
    <div class="chart-container">
        <div class="chart-header">
            <h3 class="chart-title">Revenue vs Expenses</h3>
            <div class="chart-options">
                <button class="chart-option active" data-period="week">Week</button>
                <button class="chart-option" data-period="month">Month</button>
                <button class="chart-option" data-period="year">Year</button>
            </div>
        </div>
        <div class="chart-wrapper">
            <canvas id="revenueChart"></canvas>
        </div>
    </div>

    <!-- Client Distribution -->
    <div class="chart-container">
        <div class="chart-header">
            <h3 class="chart-title">Client Distribution</h3>
        </div>
        <div class="chart-wrapper">
            <canvas id="clientChart"></canvas>
        </div>
    </div>
</div>

<!-- Recent Activity & Quick Actions -->
<div class="charts-row">
    <!-- Recent Activity -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Recent Activity</h3>
        </div>
        <div class="activity-list">
            <% if (recentClients && recentClients.length > 0) { %> <%
            recentClients.forEach(function(client) { %>
            <div class="activity-item">
                <div
                    class="activity-icon"
                    style="background: rgba(113, 23, 242, 0.1); color: var(--primary-color)"
                >
                    <i class="fas fa-user-plus"></i>
                </div>
                <div class="activity-content">
                    <div class="activity-title">New client added</div>
                    <div class="activity-desc"><%= client.company || client.name %></div>
                </div>
                <div class="activity-time">
                    <%= new Date(client.createdAt).toLocaleDateString() %>
                </div>
            </div>
            <% }); %> <% } else { %>
            <p class="text-center text-muted">No recent activity</p>
            <% } %>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Quick Actions</h3>
        </div>
        <div class="quick-actions">
            <a href="/clients/new" class="quick-action-btn">
                <div class="quick-action-icon">
                    <i class="fas fa-user-plus"></i>
                </div>
                <div class="quick-action-text">Add Client</div>
            </a>
            <a href="/proposals/new" class="quick-action-btn">
                <div class="quick-action-icon">
                    <i class="fas fa-file-alt"></i>
                </div>
                <div class="quick-action-text">Create Proposal</div>
            </a>
            <a href="/invoices/new" class="quick-action-btn">
                <div class="quick-action-icon">
                    <i class="fas fa-file-invoice"></i>
                </div>
                <div class="quick-action-text">New Invoice</div>
            </a>
            <a href="/expenses" class="quick-action-btn">
                <div class="quick-action-icon">
                    <i class="fas fa-receipt"></i>
                </div>
                <div class="quick-action-text">Track Expense</div>
            </a>
            <a href="/analysis" class="quick-action-btn">
                <div class="quick-action-icon">
                    <i class="fas fa-chart-bar"></i>
                </div>
                <div class="quick-action-text">View Reports</div>
            </a>
        </div>
    </div>
</div>

<!-- Hidden data for JavaScript -->
<div
    id="dashboardData"
    style="display: none"
    data-stats="<%= encodeURIComponent(JSON.stringify(stats)) %>"
    data-recent-clients="<%= encodeURIComponent(JSON.stringify(recentClients)) %>"
></div>
